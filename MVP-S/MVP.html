<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>StudTrack ‚Äî –ü—Ä–æ—Ç–æ—Ç–∏–ø</title>

  <!-- Tailwind for quick styling -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React + ReactDOM + Babel (for demo/prototype only) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Chart.js UMD -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    .sidebar-transition { transition: width .18s ease, transform .18s ease; }
    .card-shadow { box-shadow: 0 8px 26px rgba(15,23,42,0.06); }
    .tt { position: relative }
    .tt:hover::after {
      content: attr(data-tip);
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(100% + 8px);
      background: #111827;
      color: white;
      padding: 6px 8px;
      font-size: 12px;
      border-radius: 6px;
      white-space: nowrap;
      z-index: 40;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <div id="root"></div>

  <script type="text/babel">
  const { useState, useEffect, useMemo, useRef } = React;

  // Criteria config
  const CRITERIA_CONFIG = [
    { key: 'gpa', title: '–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å', max: 150, description: '–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª (1‚Äì5) √ó 30' },
    { key: 'courses', title: '–ö—É—Ä—Å—ã', max: 200, description: '–ö–∞–∂–¥—ã–π –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π –∫—É—Ä—Å = 20 (–º–∞–∫—Å. 10)' },
    { key: 'events', title: '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è', max: 50, description: '–ö–∞–∂–¥—ã–π —Å–µ–º–∏–Ω–∞—Ä/–≤–æ—Ä–∫—à–æ–ø = 10 (–º–∞–∫—Å. 5)' },
    { key: 'projects', title: '–ü—Ä–æ–µ–∫—Ç—ã', max: 50, description: '–ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç = 20 (–º–∏–Ω.2)' },
    { key: 'research', title: '–ù–ò–†', max: 50, description: '–ö–∞–∂–¥–∞—è –∑–∞—â–∏—â—ë–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ = 20 (–º–∏–Ω.2)' },
    { key: 'hard', title: 'Hard Skills', max: 200, description: '–ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç/–Ω–∞–≤—ã–∫ = 10 (–º–∞–∫—Å.20)' },
    { key: 'intern', title: '–ü—Ä–∞–∫—Ç–∏–∫–∞/–°—Ç–∞–∂–∏—Ä–æ–≤–∫–∏', max: 100, description: '–ú–∞–∫—Å–∏–º—É–º 25 –±–∞–ª–ª–æ–≤ –∑–∞ —Å–µ–º–µ—Å—Ç—Ä (–Ω–∞–∑–Ω–∞—á–∞–µ—Ç –∫—É—Ä–∞—Ç–æ—Ä)' },
    { key: 'recom', title: '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏', max: 50, description: '–ö–∞–∂–¥–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è = 25 (–º–∞–∫—Å.2)' },
  ];

  const DEFAULT_STATE = {
    gpa: 4.2, courses: 3, events: 2, projects: 1, research: 0, hard: 6, intern: 25, recom: 1,
    levelThreshold: 850,
    name: '–ñ–µ–Ω—è –ë–æ—Ä–∏—Å–æ–≤',
    group: '–ë–ü-401654/452467',
    avatarBg: '#60a5fa',
    dob: '2001-01-01',
    uploaded: { resume: null, certs: ['–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Python.pdf','SQL Workshop.pdf'] },
    activity: [
      { month: '–°–µ–Ω—Ç—è–±—Ä—å', points: 51 },
      { month: '–û–∫—Ç—è–±—Ä—å', points: 47 },
      { month: '–ù–æ—è–±—Ä—å', points: 48 }
    ],
  };

  // local storage hook
  function useLocalState(key, initial) {
    const [state, setState] = useState(() => {
      try {
        const raw = localStorage.getItem(key);
        return raw ? JSON.parse(raw) : initial;
      } catch { return initial; }
    });
    useEffect(() => {
      try { localStorage.setItem(key, JSON.stringify(state)); } catch {}
    }, [key, state]);
    return [state, setState];
  }

  // compute points using rules
  function computePoints(values) {
    const points = {};
    points.gpa = Math.min(150, Math.round((values.gpa * 30) * 10) / 10);
    points.courses = Math.min(200, Math.round(values.courses * 20));
    points.events = Math.min(50, Math.round(values.events * 10));
    points.projects = Math.min(50, Math.round(values.projects * 20));
    points.research = Math.min(50, Math.round(values.research * 20));
    points.hard = Math.min(200, Math.round(values.hard * 10));
    points.intern = Math.min(100, Math.round(values.intern));
    points.recom = Math.min(50, Math.round(values.recom * 25));
    const total = Object.values(points).reduce((s,v)=>s+v,0);
    return { points, total: Math.round(total*10)/10 };
  }

  /* ------------------ UI Components ------------------ */

  function Logo({size=32}) {
    return (
      <img
      src="/–Ω–æ—Ü –∏ –ø–æ–ª–∏—Ç–µ—Ö.png"   // –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
      alt="Logo"
      width={size}
      height={size}
      className="object-contain"
    />
    );
  }

  function Header({ onToggle, onOpenProfile, onToggleNotif, profile }) {
    return (
      <div className="flex items-center justify-between px-4 h-16 bg-white border-b sticky top-0 z-30">
        <div className="flex items-center gap-3">
          <button onClick={onToggle} className="p-2 rounded-md hover:bg-gray-100" aria-label="Toggle sidebar">
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
          {/* header: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏–ª —É–±—Ä–∞—Ç—å –ª–æ–≥–æ—Ç–∏–ø –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–∞ –æ—Ç –±—É—Ä–≥–µ—Ä–∞ */}
        </div>

        <div className="flex items-center gap-3">
          <button onClick={onToggleNotif} className="p-2 rounded-md hover:bg-gray-50 tt" data-tip="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" aria-label="Notifications">
            <span className="text-2xl">üîî</span>
          </button>
          <button onClick={onOpenProfile} className="flex items-center gap-3 p-1 rounded-md hover:bg-gray-50" aria-label="Open profile">
            <div className="w-9 h-9 rounded-full flex items-center justify-center text-white font-semibold" style={{background: profile.avatarBg}}>
              {profile.name.split(' ').map(s=>s[0]).slice(0,2).join('').toUpperCase()}
            </div>
            <div className="hidden sm:flex flex-col items-start">
              <div className="text-sm font-medium leading-4">{profile.name}</div>
              <div className="text-xs text-gray-400 leading-4">{profile.group}</div>
            </div>
          </button>
        </div>
      </div>
    );
  }

  function Sidebar({ collapsed, active, setActive }) {
    const items = [
      { key:'home', label: '–ì–ª–∞–≤–Ω–∞—è' },
      { key:'achievements', label: '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è' },
      { key:'courses', label: '–ö—É—Ä—Å—ã' },
      { key:'events', label: '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è' },
      { key:'profile', label: '–ü—Ä–æ—Ñ–∏–ª—å' },
      { key:'contacts', label: '–ö–æ–Ω—Ç–∞–∫—Ç—ã' },
      { key:'support', label: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞' },
    ];

    return (
      <aside className={`bg-white border-r sidebar-transition ${collapsed ? 'w-20' : 'w-64'} overflow-hidden flex flex-col`}>
        <div className="p-4 border-b">
          <div className="flex items-center gap-3">
            <div><Logo size={32} /></div>
            {!collapsed && <div className="flex flex-col">
              <div className="text-lg font-bold">StudTrack</div>
              {/* –ü–æ –∑–∞–ø—Ä–æ—Å—É: —É–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É "–ì–ª–∞–≤–Ω–æ–µ" –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º */}
            </div>}
          </div>
        </div>

        <nav className="p-3 flex-1">
          {items.map(it => (
            <button key={it.key} onClick={()=>setActive(it.key)} className={`w-full flex items-center gap-3 p-2 rounded-md text-left hover:bg-gray-50 ${active===it.key ? 'bg-indigo-50 text-indigo-600' : 'text-gray-700'}`}>
              <span className="w-6 text-center">{it.key==='home'?'üè†':it.key==='achievements'?'üèÜ':it.key==='courses'?'üéì':it.key==='events'?'üóìÔ∏è':it.key==='profile'?'üë§':it.key==='contacts'?'üìá':'üí¨'}</span>
              {!collapsed && <span className="font-medium">{it.label}</span>}
            </button>
          ))}
        </nav>

        <div className="p-3 border-t text-xs text-gray-500">StudTrack v0.1</div>
      </aside>
    );
  }

  /* ---------- Pages ---------- */

  function WeeklyCalendar({ events = [] }) {
    const days = ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å'];
    return (
      <div>
        <h3 className="text-lg font-semibold mb-3">–ö–∞–ª–µ–Ω–¥–∞—Ä—å –±–ª–∏–∂–∞–π—à–µ–π –Ω–µ–¥–µ–ª–∏</h3>
        <div className="grid grid-cols-7 gap-2 text-sm">
          {days.map(d => (
            <div key={d} className="p-3 border rounded h-24 flex flex-col justify-between">
              <div className="font-medium">{d}</div>
              <div className="text-xs text-gray-400">‚Äî</div>
            </div>
          ))}
        </div>
        <p className="text-gray-400 text-center mt-3">–ù–æ–≤—ã—Ö –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ–±—ã—Ç–∏–π –Ω–µ—Ç</p>
      </div>
    );
  }

  function Home({ totalPoints, profile, openAchievements }) {
  const LEVELS = [
    { name: '–ñ—ë–ª—Ç—ã–π —Å—Ç—É–¥–µ–Ω—Ç', min: 0, max: 99, emoji: 'üü°', tip: '–ù–∞—á–Ω–∏—Ç–µ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è.' },
    { name: '–û–∑–Ω–∞–∫–æ–º–∏–≤—à–∏–π—Å—è', min: 100, max: 199, emoji: 'üü†', tip: '–ü—Ä–æ–π–¥–∏—Ç–µ –ø–µ—Ä–≤—ã–µ –∫—É—Ä—Å—ã –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–µ–∫—Ç.' },
    { name: '–ù–æ–≤–∏—á–æ–∫', min: 200, max: 349, emoji: 'üü¢', tip: '–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –∑–∞–≤–µ—Ä—à–∏—Ç–µ –∫—É—Ä—Å, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å ‚Äú–ê–∫—Ç–∏–≤–Ω—ã–π —É—á–∞—Å—Ç–Ω–∏–∫‚Äù.' },
    { name: '–ê–∫—Ç–∏–≤–Ω—ã–π —É—á–∞—Å—Ç–Ω–∏–∫', min: 350, max: 499, emoji: 'üîµ', tip: '–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –∏ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∞—Ö.' },
    { name: '–ü—Ä–∞–∫—Ç–∏–∫–∞–Ω—Ç', min: 500, max: 699, emoji: 'üü£', tip: '–ó–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã –∏ –∫—É—Ä—Å—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è.' },
    { name: '–†–∞–∑–≤–∏–≤–∞—é—â–∏–π—Å—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', min: 700, max: 849, emoji: 'üî∑', tip: '–†–∞–∑–≤–∏–≤–∞–π—Ç–µ—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö.' },
    { name: '–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫', min: 850, max: Infinity, emoji: '‚≠ê', tip: '–í—ã –ø–æ—á—Ç–∏ –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ! –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.' },
  ];

  const currentLevel = LEVELS.find(l => totalPoints >= l.min && totalPoints <= l.max);
  const percent = Math.min(100, Math.round((totalPoints / 1000) * 100));

  const [modalLevel, setModalLevel] = React.useState(null);
  const [showHistory, setShowHistory] = React.useState(false);

  const lastMonth = profile.activity[profile.activity.length - 1];

  return (
    <div className="p-6 space-y-6">

      {/* --------- –ë–ª–æ–∫ 1: –£—Ä–æ–≤–µ–Ω—å –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è --------- */}
      <section className="bg-white card-shadow rounded-lg p-8 text-center">
        <div className="text-sm text-gray-500 mb-2">–û–±—â–∞—è —Å—É–º–º–∞ –±–∞–ª–ª–æ–≤</div>
        <div className="text-6xl font-extrabold">{totalPoints}</div>
        <div className="mt-3 text-gray-800 text-xl font-semibold">{`–¢—ã ${currentLevel.name}!`}</div>
        <div className="mt-2 text-gray-500">{`–£—á–∞—Å—Ç–≤—É–π –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö, –ø—Ä–æ—Ö–æ–¥–∏ –∫—É—Ä—Å—ã –∏ –ø—Ä–æ—è–≤–ª—è–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –∫–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç —Ç–µ–±—è –∫ —Å—Ç–∞—Ç—É—Å—É –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.`}</div>
      </section>

      {/* --------- –ë–ª–æ–∫ 2: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å —Ü–∏—Ñ—Ä–∞–º–∏ --------- */}
      <section className="bg-white card-shadow rounded-lg p-6">
        <div className="mb-4"><strong>–®–∫–∞–ª–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞</strong></div>

        {/* –¶–∏—Ñ—Ä—ã –Ω–∞–¥ —à–∫–∞–ª–æ–π */}
        <div className="relative w-full h-4 mb-2">
          <div className="absolute top-0 left-0 w-full flex justify-between text-xs text-gray-500">
            {Array.from({length: 21}, (_, i) => i * 50).map((val) => (
              <span key={val} className="transform -translate-x-1/2">
                {val}
              </span>
            ))}
          </div>
        </div>

        {/* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */}
        <div className="w-full h-3 bg-gray-200 rounded-full overflow-hidden mb-4">
          <div
            className="h-3 rounded-full"
            style={{ width: `${percent}%`, background: 'linear-gradient(90deg,#7c3aed,#06b6d4)' }}
          ></div>
        </div>

        {/* –ö—Ä—É–∂–∫–∏ —Å —É—Ä–æ–≤–Ω—è–º–∏ */}
        <div className="flex justify-between text-xs">
          {LEVELS.map((lvl, i) => {
            const isActive = totalPoints >= lvl.min;
            return (
              <div
                key={i}
                className="flex flex-col items-center cursor-pointer"
                onClick={() => setModalLevel(lvl)}
                title={`${lvl.tip} (${lvl.min}-${lvl.max} –±–∞–ª–ª–æ–≤)`}
              >
                <div
                  className={`w-8 h-8 flex items-center justify-center rounded-full text-white font-bold ${
                    isActive ? 'bg-indigo-600' : 'bg-gray-300'
                  }`}
                >
                  {lvl.emoji}
                </div>
                <div className="mt-1 text-center">{lvl.name}</div>
              </div>
            );
          })}
        </div>
      </section>

      {/* --------- –ë–ª–æ–∫ 3: –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ –º–µ—Å—è—Ü –∏ –∏—Å—Ç–æ—Ä–∏—è --------- */}
      <section className="bg-white card-shadow rounded-lg p-6">
        <div className="text-lg font-semibold mb-2">–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ {lastMonth.month}:</div>
        <div className="text-gray-600 mb-1">{`+${lastMonth.points} –±–∞–ª–ª–æ–≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏`}</div>
        <div className="text-gray-600 mb-4">{`–í—Å–µ–≥–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–æ: ${profile.activity.reduce((s,a)=>s+a.points,0)} –±–∞–ª–ª–æ–≤`}</div>
        <button onClick={() => setShowHistory(s => !s)} className="text-indigo-600 font-semibold underline mb-2">
          {showHistory ? '–°–∫—Ä—ã—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏' : '–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏'}
        </button>

        {showHistory && (
          <div className="mt-3 p-3 bg-gray-50 rounded space-y-1 text-sm text-gray-700">
            <div className="font-medium">–ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –º–µ—Å—è—Ü–∞–º:</div>
            {profile.activity.map(a => (
              <div key={a.month}>üóìÔ∏è {a.month}: {a.points} {a.month === lastMonth.month ? '(–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)' : '–±–∞–ª–ª–æ–≤'}</div>
            ))}
          </div>
        )}
      </section>

      {/* --------- –ë–ª–æ–∫ 4: –ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è/–∫–∞–ª–µ–Ω–¥–∞—Ä—å --------- */}
      <section className="bg-white card-shadow rounded-lg p-6">
        <div className="text-lg font-semibold mb-3">–ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è</div>
        <WeeklyCalendar events={[]} />
      </section>

      {/* --------- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É—Ä–æ–≤–Ω–µ–π --------- */}
      {modalLevel && (
        <div className="fixed inset-0 bg-black/40 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 max-w-md w-full text-center">
            <div className="text-lg font-semibold mb-2">{modalLevel.name}</div>
            <div className="text-gray-600 mb-4">{modalLevel.tip}</div>
            <div className="flex justify-center gap-4">
              <button onClick={() => { openAchievements(); setModalLevel(null); }} className="px-4 py-2 bg-indigo-600 text-white rounded">–ü–µ—Ä–µ–π—Ç–∏ –≤ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
              <button onClick={() => setModalLevel(null)} className="px-4 py-2 border rounded">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}



  function CoursesPage() {
    const [mode, setMode] = useState('mine'); // 'mine' | 'all'
    const [filterType, setFilterType] = useState('all');
    const [filterStatus, setFilterStatus] = useState('all');
    const [query, setQuery] = useState('');
    const coursesMine = [
      { id:1, title:'–û—Å–Ω–æ–≤—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏', status:'–ó–∞–≤–µ—Ä—à—ë–Ω', points:20, type:'–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π' },
      { id:2, title:'Python –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π', status:'–í –ø—Ä–æ—Ü–µ—Å—Å–µ', points:20, type:'–†–µ–∫–æ–º–µ–Ω–¥.' },
      { id:3, title:'Java', status:'–ù–µ –∑–∞–≤–µ—Ä—à—ë–Ω', points:0, type:'–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π' },
    ];
    const coursesAll = [
      ...coursesMine,
      { id:4, title:'–í–≤–µ–¥–µ–Ω–∏–µ –≤ ML', status:'–ù–µ –Ω–∞—á–∞—Ç', points:0, type:'–†–µ–∫–æ–º–µ–Ω–¥.' },
      { id:5, title:'–î–∏–∑–∞–π–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤', status:'–ù–µ –Ω–∞—á–∞—Ç', points:0, type:'–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π' },
    ];
    const list = mode==='mine' ? coursesMine : coursesAll;
    const filtered = list.filter(c=> (filterType==='all' || c.type===filterType) && (filterStatus==='all' || c.status===filterStatus) && c.title.toLowerCase().includes(query.toLowerCase()));

    return (
      <div className="p-6">
        <div className="bg-white card-shadow rounded-lg p-4 space-y-4">
          <div className="flex items-center gap-4">
            <div className="flex items-center gap-2">
              <button onClick={()=>setMode('mine')} className={`px-3 py-2 rounded ${mode==='mine' ? 'bg-blue-600 text-white' : 'bg-blue-50 text-blue-700'}`}>–ú–æ–∏ –∫—É—Ä—Å—ã</button>
              <button onClick={()=>setMode('all')} className={`px-3 py-2 rounded ${mode==='all' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700'}`}>–í—Å–µ –∫—É—Ä—Å—ã</button>
            </div>
            <div className="ml-auto flex gap-2">
              <select value={filterType} onChange={(e)=>setFilterType(e.target.value)} className="p-2 border rounded text-sm">
                <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                <option value="–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ</option>
                <option value="–†–µ–∫–æ–º–µ–Ω–¥.">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ</option>
                <option value="–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π">–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ</option>
              </select>
              <select value={filterStatus} onChange={(e)=>setFilterStatus(e.target.value)} className="p-2 border rounded text-sm">
                <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                <option>–ó–∞–≤–µ—Ä—à—ë–Ω</option>
                <option>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</option>
                <option>–ù–µ –∑–∞–≤–µ—Ä—à—ë–Ω</option>
                <option>–ù–µ –Ω–∞—á–∞—Ç</option>
              </select>
            </div>
          </div>

          <div className="flex items-center gap-3">
            <input value={query} onChange={(e)=>setQuery(e.target.value)} placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤..." className="flex-1 p-2 border rounded" />
          </div>

          <div className="overflow-auto">
            <table className="w-full text-left text-sm">
              <thead className="text-xs text-gray-500 border-b"><tr><th className="py-2">–ö—É—Ä—Å</th><th className="py-2">–°—Ç–∞—Ç—É—Å</th><th className="py-2">–ë–∞–ª–ª—ã</th></tr></thead>
              <tbody>
                {filtered.map(c => (
                  <tr key={c.id} className="border-b">
                    <td className="py-3">{c.title}</td>
                    <td className="py-3">{c.status}</td>
                    <td className="py-3 font-semibold">{c.points}</td>
                  </tr>
                ))}
                {filtered.length===0 && <tr><td colSpan="3" className="py-4 text-center text-gray-400">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</td></tr>}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    );
  }

  function EventsPage() {
  const [mode, setMode] = useState('mine');
  const [filterType, setFilterType] = useState('all');   // –¢–∏–ø: –°–µ–º–∏–Ω–∞—Ä, –í–æ—Ä–∫—à–æ–ø, –•–∞–∫–∞—Ç–æ–Ω
  const [filterStatus, setFilterStatus] = useState('all'); // –°—Ç–∞—Ç—É—Å: –ó–∞–ø–∏—Å–∞–Ω, –ù–µ –∑–∞–ø–∏—Å–∞–Ω
  const [filterMandatory, setFilterMandatory] = useState('all'); // –ù–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä
  const [query, setQuery] = useState('');

  const all = [
    { id:1, title:'–°–µ–º–∏–Ω–∞—Ä –ø–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ', date:'2025-11-03', points:10, status:'–ó–∞–ø–∏—Å–∞–Ω', type: '–°–µ–º–∏–Ω–∞—Ä', mandatory:'–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ' },
    { id:2, title:'–í–æ—Ä–∫—à–æ–ø –ø–æ SQL', date:'2025-11-10', points:10, status:'–ù–µ –∑–∞–ø–∏—Å–∞–Ω', type: '–í–æ—Ä–∫—à–æ–ø', mandatory:'–†–µ–∫–æ–º–µ–Ω–¥.' },
    { id:3, title:'–•–∞–∫–∞—Ç–æ–Ω Data', date:'2025-12-01', points:20, status:'–ó–∞–ø–∏—Å–∞–Ω', type: '–•–∞–∫–∞—Ç–æ–Ω', mandatory:'–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ' },
  ];
  const mine = all.filter(a => a.status==='–ó–∞–ø–∏—Å–∞–Ω');

  const list = mode==='mine' ? mine : all;
  const filtered = list.filter(e => 
    e.title.toLowerCase().includes(query.toLowerCase()) &&
    (filterStatus==='all' || e.status===filterStatus) &&
    (filterType==='all' || e.type===filterType) &&
    (filterMandatory==='all' || e.mandatory===filterMandatory)
  );

  return (
    <div className="p-6">
      <div className="bg-white card-shadow rounded-lg p-4 space-y-4">
        <div className="flex items-center gap-4">
          <div className="flex items-center gap-2">
            <button onClick={()=>setMode('mine')} className={`px-3 py-2 rounded ${mode==='mine' ? 'bg-blue-600 text-white' : 'bg-blue-50 text-blue-700'}`}>–ú–æ–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</button>
            <button onClick={()=>setMode('all')} className={`px-3 py-2 rounded ${mode==='all' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700'}`}>–í—Å–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</button>
          </div>
          <div className="ml-auto flex gap-2">
            <select value={filterType} onChange={(e)=>setFilterType(e.target.value)} className="p-2 border rounded text-sm">
              <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
              <option value="–°–µ–º–∏–Ω–∞—Ä">–°–µ–º–∏–Ω–∞—Ä—ã</option>
              <option value="–í–æ—Ä–∫—à–æ–ø">–í–æ—Ä–∫—à–æ–ø—ã</option>
              <option value="–•–∞–∫–∞—Ç–æ–Ω">–•–∞–∫–∞—Ç–æ–Ω—ã</option>
            </select>
            <select value={filterStatus} onChange={(e)=>setFilterStatus(e.target.value)} className="p-2 border rounded text-sm">
              <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
              <option value="–ó–∞–ø–∏—Å–∞–Ω">–ó–∞–ø–∏—Å–∞–Ω</option>
              <option value="–ù–µ –∑–∞–ø–∏—Å–∞–Ω">–ù–µ –∑–∞–ø–∏—Å–∞–Ω</option>
            </select>
            {/* –ù–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä */}
            <select value={filterMandatory} onChange={(e)=>setFilterMandatory(e.target.value)} className="p-2 border rounded text-sm">
              <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
              <option value="–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ</option>
              <option value="–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ">–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ</option>
              <option value="–†–µ–∫–æ–º–µ–Ω–¥.">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ</option>
            </select>
          </div>
        </div>

        <div className="flex items-center gap-3">
          <input value={query} onChange={(e)=>setQuery(e.target.value)} placeholder="–ü–æ–∏—Å–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π..." className="flex-1 p-2 border rounded" />
        </div>

        <div className="overflow-auto">
          <table className="w-full text-left text-sm">
            <thead className="text-xs text-gray-500 border-b">
              <tr>
                <th className="py-2">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</th>
                <th className="py-2">–î–∞—Ç–∞</th>
                <th className="py-2">–ë–∞–ª–ª—ã</th>
                <th className="py-2">–°—Ç–∞—Ç—É—Å</th>
                <th className="py-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
              </tr>
            </thead>
            <tbody>
              {filtered.map(ev => (
                <tr key={ev.id} className="border-b">
                  <td className="py-3">{ev.title} <div className="text-xs text-gray-400">{ev.type}</div></td>
                  <td className="py-3">{ev.date}</td>
                  <td className="py-3">{ev.points}</td>
                  <td className="py-3">{ev.status}</td>
                  <td className="py-3">{ev.mandatory}</td>
                </tr>
              ))}
              {filtered.length===0 && <tr><td colSpan="5" className="py-4 text-center text-gray-400">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</td></tr>}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}


  function ProfilePage({ profile, setProfile }) {
  const onCertFiles = (e) => {
    const files = e.target.files;
    if (!files?.length) return;

    const arr = Array.from(files).map(f => f.name);

    setProfile(prev => ({
      ...prev,
      uploaded: {
        ...(prev.uploaded ?? {}),
        certs: [ ...(prev.uploaded?.certs ?? []), ...arr ]
      }
    }));
  };

  const onResume = (e) => {
    const files = e.target.files;
    if (!files?.length) return;

    setProfile(prev => ({
      ...prev,
      uploaded: {
        ...(prev.uploaded ?? {}),
        resume: files[0].name
      }
    }));
  };

  // –§—É–Ω–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞—Ç—ã
  const formatDob = () => {
    profile.dob = "2001-01-01";
    const dob = profile.dob;
    if (!dob) return "‚Äî";

    try {
      const d = new Date(dob);
      if (!isNaN(d)) {
        const dd = String(d.getDate()).padStart(2, "0");
        const mm = String(d.getMonth() + 1).padStart(2, "0");
        const yyyy = d.getFullYear();
        return `${dd}.${mm}.${yyyy}`;
      }
    } catch {}

    if (typeof dob === "string" && dob.includes(".")) return dob;

    return dob;
  };

  return (
    <div className="p-6">
      <div className="bg-white card-shadow rounded-lg p-6 max-w-3xl">
        <div className="flex items-center gap-4">
          <div
            className="w-20 h-20 rounded-full flex items-center justify-center text-white font-bold"
            style={{ background: profile.avatarBg }}
          >
            {profile.name.split(" ").map(s => s[0]).slice(0, 2).join("").toUpperCase()}
          </div>

          <div>
            <div className="text-lg font-semibold">{profile.name}</div>
            <div className="text-sm text-gray-500">{profile.group}</div>
            <div className="text-sm text-gray-500">
              –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: {formatDob()}
            </div>
          </div>
        </div>

        <div className="mt-6 space-y-4">
          <div>
            <div className="font-medium">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—é–º–µ</div>
            <input type="file" accept=".pdf,.doc,.docx" onChange={onResume} className="mt-2" />
            <div className="mt-2 text-sm">
              {profile.uploaded?.resume
                ? <>–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ä–µ–∑—é–º–µ: <strong>{profile.uploaded.resume}</strong> ‚úÖ</>
                : <span className="text-gray-400">–†–µ–∑—é–º–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ</span>
              }
            </div>
          </div>

          <div>
            <div className="font-medium">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã</div>
            <input type="file" multiple onChange={onCertFiles} className="mt-2" />

            <div className="mt-3">
              <div className="font-medium">–°–ø–∏—Å–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤</div>
              <ul className="list-disc ml-6 mt-2">
               {Array.isArray(profile.uploaded?.certs) && profile.uploaded.certs.length > 0
        ? profile.uploaded.certs.map((c, i) => (
            <li key={i} className="text-sm">
              {c} <span className="text-green-600">‚úÖ</span>
            </li>
          ))
        : <li className="text-sm text-gray-400">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –Ω–µ—Ç</li>
      }
              </ul>
            </div>
          </div>
        </div>

      </div>
    </div>
  );
}

  function ContactsPage() {
    const contacts = [
      {role: '–†–µ–∫—Ç–æ—Ä', name: '–†–µ–∫—Ç–æ—Ä –ò–≤–∞–Ω–æ–≤', email: 'rector@university.ru'},
      {role: '–ö—É—Ä–∞—Ç–æ—Ä –ø—Ä–∞–∫—Ç–∏–∫–∏', name: '–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è', email: 'curator.practice@university.ru'},
      {role: '–û—Ç–¥–µ–ª –ø–æ–¥–¥–µ—Ä–∂–∫–∏', name: 'Support Team', email: 'support@university.ru'},
      {role: '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∫—É—Ä—Å–æ–≤', name: '–°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π', email: 'courses@university.ru'},
    ];
    return (
      <div className="p-6">
        <div className="bg-white card-shadow rounded-lg p-6">
          <h3 className="font-semibold mb-4">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
          <ul className="space-y-2">
            {contacts.map((c,i)=>(

              <li key={i} className="text-sm"><strong>{c.role}:</strong> {c.name} ‚Äî <a className="text-indigo-600" href={`mailto:${c.email}`}>{c.email}</a></li>
            ))}
          </ul>
        </div>
      </div>
    );
  }

  function SupportModal({ open, onClose }) {
    const [text, setText] = useState('');
    if(!open) return null;
    return (
      <div className="fixed inset-0 bg-black/40 flex items-center justify-center z-50">
        <div className="bg-white rounded p-6 w-full max-w-lg">
          <div className="flex items-center justify-between">
            <div className="font-semibold">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
            <button onClick={onClose} className="text-gray-500">‚úï</button>
          </div>
          <textarea value={text} onChange={(e)=>setText(e.target.value)} maxLength={1000} rows={6} className="w-full border p-3 rounded mt-4" placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É (–¥–æ 1000 —Å–∏–º–≤–æ–ª–æ–≤)"></textarea>
          <div className="mt-4 flex justify-center">
            <button onClick={()=>{ alert('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (—ç–º—É–ª—è—Ü–∏—è)'); setText(''); onClose(); }} className="px-4 py-2 bg-blue-600 text-white rounded">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
          </div>
        </div>
      </div>
    );
  }

  function AchievementsPage({ points, onOpenCriterion }) {
  const canvasRef = useRef(null);

  useEffect(() => {
    const labels = CRITERIA_CONFIG.map(c => c.title);
    const data = CRITERIA_CONFIG.map(c => Math.min(points[c.key] || 0, c.max));
    const maxData = CRITERIA_CONFIG.map(c => c.max); // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

    const ctx = canvasRef.current.getContext('2d');
    let chart;
    try {
      chart = new Chart(ctx, {
        type: 'radar',
        data: {
          labels,
          datasets: [
            {
              label: '–ú–∞–∫—Å–∏–º—É–º',
              data: maxData,
              backgroundColor: 'rgba(255,0,0,0.1)',
              borderColor: 'red',
              pointBackgroundColor: 'red',
              borderWidth: 2,
              pointRadius: 4, // –†–∞–¥–∏—É—Å —Ç–æ—á–∫–∏
              
            },
            {
              label: '–¢–µ–∫—É—â–∏–µ –±–∞–ª–ª—ã',
              data,
              backgroundColor: 'rgba(124,58,237,0.15)',
              borderColor: '#7c3aed',
              pointBackgroundColor: '#7c3aed',
              borderWidth: 2,
              pointRadius: 4, // –†–∞–¥–∏—É—Å —Ç–æ—á–∫–∏


            }
          ]
        },
        options: {
          scales: {
            r: {
              beginAtZero: true,
              suggestedMax: Math.max(...maxData),
              ticks: { stepSize: 50 }
            }
          },
          plugins: {
            legend: { display: true, position: 'bottom' }
          }
        }
      });
    } catch(e) { console.error(e); }
    return () => { if(chart) chart.destroy(); };
  }, [points]);

  const total = Object.values(points).reduce((s,v)=>s+(v||0),0);

  return (
    <div className="p-6">
      <div className="bg-white card-shadow rounded-lg p-6">
        <div className="flex gap-6 items-center">
          <div className="w-1/2">
            <canvas ref={canvasRef} width={420} height={420}></canvas>
          </div>
          <div className="flex-1">
            <div className="text-sm text-gray-500">–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤</div>
            <div className="text-5xl font-bold">{total}</div>
            <div className="mt-4 text-sm text-gray-600">
              –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º. –ö—Ä–∞—Å–Ω—ã–π ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Å–∏–Ω–∏–π ‚Äî –≤–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –±–∞–ª–ª—ã.
            </div>
          </div>
        </div>

        <div className="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3">
          {CRITERIA_CONFIG.map(c => (
            <button key={c.key} onClick={()=>onOpenCriterion(c)} className="p-3 border rounded text-left hover:bg-gray-50 flex justify-between items-center">
              <div>
                <div className="font-medium">{c.title}</div>
                <div className="text-xs text-gray-400">{c.description}</div>
              </div>
              <div className="text-sm font-semibold">{points[c.key] || 0} / {c.max}</div>
            </button>
          ))}
        </div>
      </div>
    </div>
  );
}


  function CriterionDetail({ criterion, points, onBack }) {
    return (
      <div className="p-6">
        <div className="bg-white card-shadow rounded-lg p-6 max-w-4xl mx-auto">
          <div className="flex items-center justify-between">
            <div>
              <div className="text-lg font-semibold">{criterion.title}</div>
              <div className="text-sm text-gray-500">{points} / {criterion.max} –±–∞–ª–ª–æ–≤</div>
            </div>
            <div>
              <button onClick={onBack} className="px-3 py-1 border rounded">–ù–∞–∑–∞–¥</button>
            </div>
          </div>

          <div className="mt-6 text-sm text-gray-700">
            {criterion.key === 'gpa' && (
              <div>
                <div className="font-medium">–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å–µ–º–µ—Å—Ç—Ä–æ–≤</div>
                <table className="w-full text-sm mt-3">
                  <thead className="text-xs text-gray-400"><tr><th>–°–µ–º–µ—Å—Ç—Ä</th><th>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</th><th>–ë–∞–ª–ª—ã (i)</th><th>–°–µ—Å—Å–∏—è</th></tr></thead>
                  <tbody>
                    <tr><td>1</td><td>4.2</td><td>126</td><td>–ó–∞–∫—Ä—ã—Ç–∞</td></tr>
                    <tr><td>1 (–î–æ–ø—Å–∞)</td><td>-</td><td>0</td><td>–î–æ–ø—Å–∞</td></tr>
                  </tbody>
                </table>
                <div className="mt-3 text-xs text-gray-500">–ë–∞–ª–ª—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞. –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è ¬´–î–æ–ø—Å–∞¬ª ‚Äî –±–∞–ª–ª—ã –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è.</div>
              </div>
            )}

            {criterion.key === 'hard' && (
              <div>
                <div className="font-medium">Hard skills ‚Äî —Ç–µ—Å—Ç—ã –∏ –Ω–∞–≤—ã–∫–∏</div>
                <table className="w-full text-sm mt-3">
                  <thead className="text-xs text-gray-400"><tr><th>–ù–∞–≤—ã–∫ / –¢–µ—Å—Ç</th><th>–¢–∏–ø</th><th>–ë–∞–ª–ª—ã</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
                  <tbody>
                    <tr><td>Python —Ç–µ—Å—Ç</td><td>–¢–µ—Å—Ç</td><td>10</td><td>‚úÖ</td></tr>
                    <tr><td>SQL —Ç–µ—Å—Ç</td><td>–¢–µ—Å—Ç</td><td>10</td><td>‚úÖ</td></tr>
                    <tr><td>Excel –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</td><td>–ù–∞–≤—ã–∫</td><td>10</td><td>‚ùå</td></tr>
                  </tbody>
                </table>
                <div className="mt-2 text-xs text-gray-500">–ú–∞–∫—Å–∏–º—É–º 20 —Ç–µ—Å—Ç–æ–≤ √ó 10 –±–∞–ª–ª–æ–≤ = 200</div>
              </div>
            )}

            {criterion.key === 'projects' && (
              <div>
                <div className="font-medium">–ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div>
                <table className="w-full text-sm mt-3">
                  <thead className="text-xs text-gray-400"><tr><th>–ü—Ä–æ–µ–∫—Ç</th><th>–î–∞—Ç–∞ —Å–¥–∞—á–∏</th><th>–ë–∞–ª–ª—ã</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
                  <tbody>
                    <tr><td>–ü—Ä–æ–µ–∫—Ç –ø–æ Python</td><td>20.11</td><td>20</td><td>–ü—Ä–∏–Ω—è—Ç</td></tr>
                    <tr><td>–ü—Ä–æ–µ–∫—Ç –ø–æ Data Science</td><td>25.11</td><td>20</td><td>–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</td></tr>
                  </tbody>
                </table>
                <div className="mt-2 text-xs text-gray-500">–ú–∏–Ω–∏–º—É–º 2 –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –±–∞–ª–ª–∞ (50)</div>
              </div>
            )}

            {['courses','events','research','intern','recom'].includes(criterion.key) && (
              <div>
                <div className="font-medium">–î–µ—Ç–∞–ª–∏ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—é</div>
                <div className="mt-3 text-sm text-gray-600">{criterion.description}</div>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  }

  /* ------------------ App ------------------ */

  function App() {
    const [collapsed, setCollapsed] = useLocalState('st_collapsed', false); // —Å–∞–π–¥–±–∞—Ä —Å–≤–µ—Ä–Ω—É—Ç/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç
    const [active, setActive] = useLocalState('st_active', 'home');        // —Ç–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
    const [values, setValues] = useLocalState('st_values', DEFAULT_STATE);  // –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
    const [profile, setProfile] = useState({
    name: DEFAULT_STATE.name,
    group: DEFAULT_STATE.group,
    avatarBg: DEFAULT_STATE.avatarBg,
    dob: DEFAULT_STATE.dob,
    uploaded: { resume: null, certs: [] },
    activity: DEFAULT_STATE.activity
    });

    const { points, total } = computePoints(values);

    const [notifOpen, setNotifOpen] = useState(false);
    const [supportOpen, setSupportOpen] = useState(false);

    // achievements detail state
    const [selectedCriterion, setSelectedCriterion] = useState(null);

    useEffect(() => {
      // store profile.activity into values for Home usage (local only)
      setValues(prev => ({ ...prev, activity: profile.activity || DEFAULT_STATE.activity }));
    }, []); // only initial

    function openAchievements() {
      setActive('achievements');
      setSelectedCriterion(null);
    }

    return (
      <div className="min-h-screen flex">
        <Sidebar collapsed={collapsed} active={active} setActive={(k)=>{ setActive(k); setSelectedCriterion(null); if(k==='support') setSupportOpen(true); }} />
        <div className="flex-1 flex flex-col">
          <Header onToggle={()=>setCollapsed(s=>!s)} onOpenProfile={()=>setActive('profile')} onToggleNotif={()=>setNotifOpen(s=>!s)} profile={profile} />

          <main className="flex-1 overflow-auto bg-gray-50">
            {/* route switch */}
            {active === 'home' && <Home totalPoints={total} profile={profile} openAchievements={openAchievements} />}

            {active === 'courses' && <CoursesPage />}

            {active === 'events' && <EventsPage />}

            {active === 'profile' && <ProfilePage profile={profile} setProfile={setProfile} />}

            {active === 'contacts' && <ContactsPage />}

            {active === 'support' && (
              <div className="p-6 flex items-center justify-center">
                <div className="bg-white card-shadow p-8 rounded-lg text-center max-w-lg w-full">
                  <div className="text-lg font-semibold mb-4">–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?</div>
                  <div className="mb-6 text-sm text-gray-500">–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.</div>
                  <button onClick={()=>setSupportOpen(true)} className="px-6 py-3 bg-blue-600 text-white rounded-lg text-sm font-semibold shadow">–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É</button>
                </div>
              </div>
            )}

            {active === 'achievements' && !selectedCriterion && <AchievementsPage points={points} onOpenCriterion={(c)=>setSelectedCriterion(c)} />}

            {active === 'achievements' && selectedCriterion && <CriterionDetail criterion={selectedCriterion} points={points[selectedCriterion.key] || 0} onBack={()=>setSelectedCriterion(null)} />}
          </main>

          <footer className="text-xs text-gray-400 p-3 text-center">StudTrack ‚Äî –ø—Ä–æ—Ç–æ—Ç–∏–ø. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</footer>
        </div>

        <SupportModal open={supportOpen} onClose={()=>setSupportOpen(false)} />

        {notifOpen && (
          <div className="fixed right-6 top-20 bg-white border rounded shadow p-4 z-40">
            <div className="font-semibold">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
            <div className="text-sm text-gray-600 mt-2">–ù–µ—Ç –Ω–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
          </div>
        )}
      </div>
    );
  }

  ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
